<div class='row'>
    <div class='col-6 offset-3'>
        <div id="carouselExampleControls" class="carousel slide mb-3" data-bs-ride="carousel">
            <div class="carousel-inner">
            {{#each spot.images}}
            {{#ifEquals @index 0 }}
                <div class="carousel-item active">
                    <img src='{{ url }}' alt='Image of {{ spot.name }}' class="d-block w-100">
                </div>
                {{else}}
                <div class="carousel-item">
                    <img src='{{ url }}' alt='Image of {{ spot.name }}' class="d-block w-100">
                </div>
            </div>
            {{/ifEquals}}
            {{#iff ../spot.images.length '>' 1}}
            <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
            {{/iff}}
            {{/each}}
        </div>
    </div>
    <div class='col-6 offset-3'>
        <div class='card mb-3'>
            <div class='card-body'>
                <h5 class='card-title'>{{ spot.name }}</h5>
                <p class='card-text'>{{ spot.description }}</p>
            </div>
            <ul class='list-group list-group-flush'>
                <li class='list-group-item text-muted'>{{ spot.location }}</li>
                <li class='list-group-item '>Thanks to {{ spot.author.username }} for sharing â™¡</li>
            </ul>

            {{log 'auth' spot.author._id 'sessuser' sessionUser._id}}
            {{#if sessionUser}}
            {{#ifEquals spot.author._id sessionUser._id }}
            <div class='card-body'>
                <a href='/spots/{{ spot._id }}/edit' class='card-link'>Edit</a>
                <form class='d-inline ml-3' action='{{ spot._id }}/delete?_method=DELETE' method='POST'>
                    <button id="delete" class='card-link'>Delete</button>
                </form>
            </div>
            {{else}}
            {{/ifEquals}}
            {{/if}}
            <div class='card-footer text-muted'>
                Last update : {{ updatedAt }}
            </div>
        </div>
        {{!-- hide from author --}}
        <article class='card mb-3'>
            <div class='card-body'>
                <h4 class='card-title display-6'>
                    Tell us!
                    <small class='text-muted'>Is {{ spot.name }} cute?</small>
                </h4>
                <div class='card-body'>
                    {{#if sessionUser}}
                    <form action='/spots/{{ spot._id }}/reviews' method='POST' novalidate class='validated_form'>
                        <section class='mb-3'>
                            <label for='rating' class='form-label'>Rating</label>
                            <input aria-label='range input for rating' type='range' min='0' max='5' step='1' class='form-range' id='rating' name='review[rating]'>
                        </section>
                        <section class='mb-3'>
                            <label class='form-label' for='body'>Notes</label>
                            <textarea class='form-control' name='review[body]' id='body' cols='30' rows='2' required></textarea>
                            <div class='valid-feedback'>
                            Looks good!
                            </div>
                            <div class='invalid-feedback'>
                            Please add a review.
                            </div>
                        </section>
                        <div>
                            <button class='btn btn-info'>Submit</button>
                        </div>
                    </form>
                    {{else}}
                    <div class='card-body'>
                        <p class='card-text'>You must be logged in to leave a review!</p>
                        <a href='/login' class='card-link btn btn-info '>Login</a>
                    </div>
                    {{/if}}
                </div>
            </div>
        </article>
        <section class='card reviews mb4'>
            <h4 class='display-6 px-2 mt-5 mb-4'>What people are saying :</h4>
            {{#each spot.reviews}}
            <article class='card-body mb-3'>
                <section class='card-body'>
                    <h5 class='card-title'>Rating : {{ rating }} / 5</h5>
                    <h6 class="card-subtitle mb-2 text-muted">Author: {{author.username}}</h6>
                    <p class='card-text'>Review : {{ body }}</p>
                </section>
            </article>
            {{#if ../sessionUser}}
            {{log author._id ../sessionUser._id}}
            {{#ifEquals author._id ../sessionUser._id}}
            {{log ./author._id .../sessionUser._id}}
            <div class='card-footer'>
                <a href='/spots/{{ ../spot._id }}/reviews/{{this._id}}/edit' class='card-link'>Edit</a>
                <form class='d-inline ml-3' action='/spots/{{ ../spot._id }}/reviews/{{ this._id }}?_method=DELETE' method='POST'>   
                    <button id="delete" class='card-link'>Delete Review</button>
                </form>
            </div>
            {{else}}
            {{/ifEquals}}
            {{/if}}
            {{/each}}
        </section>
    </div>
</div>
    
    